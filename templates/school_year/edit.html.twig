{% extends 'base.html.twig' %}

{% block title %}Modifier une année scolaire
{% endblock %}

{% block body %}

	<main
		class="flex-1 bg-white p-12 font-sans">
		{# Header Section #}
		<div class="mb-8">
			<h1 class="text-3xl font-semibold text-slate-800 mb-6">Promotion
				{{ year.year }}</h1>

			{# Form Section #}
			{{ form_start(form) }}

			<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
				<div>
					{{ form_label(form.year, 'Année - champ obligatoire', {'label_attr': {'class': 'block text-sm font-medium text-slate-700 mb-2'}}) }}
					{{ form_widget(form.year, {'attr': {'class': 'w-full px-4 py-3 border border-slate-200 rounded-md focus:outline-none focus:ring-2 focus:ring-slate-500 bg-gray-50'}}) }}
					{{ form_errors(form.year) }}
				</div>

				<div>
					{{ form_label(form.saison, 'Saison (format YYYY/YYYY) - champ obligatoire', {'label_attr': {'class': 'block text-sm font-medium text-slate-700 mb-2'}}) }}
					{{ form_widget(form.saison, {'attr': {'class': 'w-full px-4 py-3 border border-slate-200 rounded-md focus:outline-none focus:ring-2 focus:ring-slate-500 bg-gray-50'}}) }}
					{{ form_errors(form.saison) }}
				</div>
			</div>

			{# Buttons Section #}
			<div class="flex gap-4 mb-12">
				<twig:Button label="Retour à la liste" variant="grey" href="{{ path('app_school_year') }}"/>
				<button type="button" id="deleteButton" class="bg-red-600 text-white hover:bg-red-700 focus:ring-red-600 inline-flex items-center justify-center rounded-lg px-12 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-2 focus:ring-offset-2">
					Supprimer
				</button>
				<twig:Button label="Enregistrer les informations" variant="blue" type="submit"/>
			</div>

			{{ form_end(form) }}
		</div>

		{# Course Weeks Section #}
		<div class="mt-8">
			<h2 class="text-2xl font-semibold text-amber-400 mb-4">Semaines de cours</h2>
			<p class="text-slate-600 mb-6">
				Les semaines de cours permettent de contrôler l'ajout des interventions. Une intervention a lieu uniquement pendant les semaines de cours.
			</p>

			{# Course Weeks Table #}
			<div class="bg-white rounded-lg overflow-hidden border border-slate-200">
				{% if course is empty %}
					<p class="text-slate-500 text-center py-8">Aucune semaine de cours ajoutée pour cette année.</p>
				{% else %}
					{# Table Header #}
					<div class="grid grid-cols-3 gap-4 bg-gray-50 px-6 py-4 border-b border-slate-200">
						<div class="text-sm font-medium text-slate-700">Date début</div>
						<div class="text-sm font-medium text-slate-700">Date de fin</div>
						<div></div>
					</div>

					{# Table Rows #}
					{% for courseWeek in course %}
						<div class="grid grid-cols-3 gap-4 px-6 py-5 border-b border-slate-200 hover:bg-gray-50 transition items-center">
							<div class="text-slate-900">{{ courseWeek.startDate|date('d/m/Y') }}</div>
							<div class="text-slate-900">{{ courseWeek.endDate|date('d/m/Y') }}</div>
							<div class="flex justify-end">
								<a href="#" class="flex items-center gap-2 text-slate-600 hover:text-slate-900 transition">
									<svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
									</svg>
									<span class="text-sm">Accéder à la fiche</span>
								</a>
							</div>
						</div>
					{% endfor %}
				{% endif %}
			</div>

			{# Add Button #}
			<div class="mt-6">
				<twig:Button label="Ajouter une semaine de cours" variant="blue" type="button" href="#"/>
			</div>
		</div>
	</main>

	{# Delete Confirmation PopUp #}
	<div id="deletePopUp" class="fixed inset-0 bg-red bg-opacity-50 items-center justify-center z-50 hidden">
		<div
			class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
			{# PopUp Header #}
			<div class="flex items-start justify-between p-6 border-b border-gray-200">
				<div class="flex items-start gap-4">
					<div class="shrink-0 w-10 h-10 bg-slate-800 rounded-lg flex items-center justify-center">
						<svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
						</svg>
					</div>
					<div>
						<h3 class="text-lg font-semibold text-slate-900">Supprimer l'année scolaire</h3>
						<p class="text-sm text-slate-500 mt-1">Confirmation de l'action</p>
					</div>
				</div>
				<button type="button" id="closePopUp" class="text-gray-400 hover:text-gray-600 transition">
					<svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
					</svg>
				</button>
			</div>

			{# PopUp Body #}
			<div class="p-6">
				<p class="text-slate-700 leading-relaxed">
					Vous vous apprêtez à supprimer l'année scolaire, cette action est irrévocable. 
																																																																																																																																																											A noter qu'aucune intervention ne doit être liée à cette année pour pouvoir la supprimer.
				</p>
				<p class="text-slate-700 font-medium mt-4">
					Confirmez-vous l'action ?
				</p>
			</div>

			{# PopUp Footer #}
			<div class="flex gap-3 p-6 border-t border-gray-200">
				<twig:Button label="Annuler" variant="grey"/>
				<twig:Button label="Confirmer" variant="red" type="submit" href="{{ path('app_school_year_delete', {'id': year.id}) }}"/>
			</div>
		</div>
	</div>

	<script>
		// indentation bizarre
document.addEventListener("DOMContentLoaded", function () {
const deleteButton = document.getElementById("deleteButton");
const deletePopUp = document.getElementById("deletePopUp");
const closePopUp = document.getElementById("closePopUp");
const cancelButton = document.getElementById("cancelButton");

// Open
deleteButton.addEventListener("click", function () {
deletePopUp.classList.remove("hidden");
deletePopUp.classList.add("flex");
});

// Close
function hidePopUp() {
deletePopUp.classList.add("hidden");
deletePopUp.classList.remove("flex");
}

closePopUp.addEventListener("click", hidePopUp);
cancelButton.addEventListener("click", hidePopUp);

// Close clique côté
deletePopUp.addEventListener("click", function (e) {
if (e.target === deletePopUp) {
hidePopUp();
}
});
});
	</script>
{% endblock %}
